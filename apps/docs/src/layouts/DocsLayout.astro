---
import "../styles/global.css";
import { docsNavigation, isDocLinkActive } from "../content/docs";
import { HeaderActions } from "@/components/HeaderActions";

interface Props {
  title: string;
  description: string;
  pageTitle?: string;
}

const { title, description, pageTitle } = Astro.props;
const pathname = Astro.url.pathname;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="description" content={description} />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <title>{title}</title>
  </head>
  <body>
    <header class="sticky top-0 z-20 mx-auto flex h-16 w-full max-w-[1080px] items-center justify-between border-x border-b border-border bg-background px-6">
      <a class="inline-flex items-center gap-2 text-base font-bold text-foreground no-underline hover:no-underline" href="/">
        <svg class="size-4 stroke-[1.8] text-accent" viewBox="0 0 24 24" aria-hidden="true" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="6" cy="6" r="2.4"></circle>
          <circle cx="18" cy="6" r="2.4"></circle>
          <circle cx="12" cy="18" r="2.4"></circle>
          <path d="M8 7.2 10.8 16.8"></path>
          <path d="M16 7.2 13.2 16.8"></path>
          <path d="M8.2 6H15.8"></path>
        </svg>
        better-worktree
      </a>
      <HeaderActions />
    </header>

    <div class="mx-auto grid w-full max-w-[1080px] grid-cols-1 gap-8 border-x border-b border-border p-6 md:grid-cols-[220px_1fr]">
      <aside class="max-h-none overflow-y-visible border-b border-border pb-4 md:sticky md:top-[88px] md:max-h-[calc(100vh-96px)] md:overflow-y-auto md:border-b-0 md:pb-0" aria-label="Documentation">
        {
          docsNavigation.map((section) => (
            <section class="mb-6">
              <p class="mb-2 text-xs font-semibold uppercase tracking-[0.05em] text-muted-foreground">{section.title}</p>
              <nav class="grid gap-1">
                {section.links.map((link) => (
                  <a
                    class={`block border-l-2 py-1 pl-2 text-[13px] no-underline transition-colors hover:text-secondary-dark ${
                      isDocLinkActive(pathname, link.href)
                        ? "border-l-secondary/70 font-medium text-secondary"
                        : "border-l-transparent text-muted-foreground"
                    }`}
                    href={link.href}
                    aria-current={isDocLinkActive(pathname, link.href) ? "page" : undefined}
                  >
                    {link.label}
                  </a>
                ))}
              </nav>
            </section>
          ))
        }
      </aside>

      <main class="min-w-0 max-w-[720px]">
        {
          pageTitle && (
            <div class="mb-6">
              <p class="mb-1 text-xs uppercase tracking-[0.05em] text-muted-foreground">Documentation</p>
              <h1 class="text-3xl font-medium text-foreground">{pageTitle}</h1>
            </div>
          )
        }
        <slot />
      </main>
    </div>
  </body>
</html>
