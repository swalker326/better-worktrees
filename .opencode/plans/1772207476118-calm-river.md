# Plan: Fix Tab Select Component Usage

## Problem
The `tab-select` component is **uncontrolled** (manages its own internal selection), but we're incorrectly:
1. Reordering the options array based on state - this causes tabs to visually swap when switching
2. Not using a ref to programmatically control the tab selection

## Solution
1. Keep static options array (don't reorder based on state)
2. Use `useRef` to programmatically switch tabs when needed (e.g., when user selects a repo)

## Files to Modify
- `apps/cli/src/tui/App.tsx` - Fix tab-select usage

## Changes

### App.tsx
```tsx
// Add useRef import
import { useRef } from "react";

// Add ref for tab-select
const tabSelectRef = useRef<any>(null);

// Static options - NO reordering!
const TAB_OPTIONS = [
  { name: "Repos", description: "Saved and open repos", value: "repos" },
  { name: "Trees", description: "Worktrees in current repo", value: "worktrees" },
];

// Update handleActivateRepo to use ref
const handleActivateRepo = (index: number) => {
  void activateRepoFromList(index);
  // Programmatically switch to worktrees tab using ref
  tabSelectRef.current?.setSelectedIndex(1);
};

// Remove options reordering logic - just use static array
<tab-select
  ref={tabSelectRef}
  options={TAB_OPTIONS}
  tabWidth={15}
  onChange={(_, option) => {
    if (!option) return;
    setActiveTab(option.value === "worktrees" ? "worktrees" : "repos");
  }}
  onSelect={(_, option) => {
    if (!option) return;
    setActiveTab(option.value === "worktrees" ? "worktrees" : "repos");
  }}
/>
```

## Verification
1. Run `bun run dev` to launch TUI
2. Switch between Repos and Trees tabs - order should stay stable
3. Select a repo - should switch to Trees tab without visual swap
4. Run `bun test && bunx tsc --noEmit`
